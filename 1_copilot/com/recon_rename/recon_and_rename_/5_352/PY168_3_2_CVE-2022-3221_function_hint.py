import logging
from rdiffweb.controller import Controller, flash
from rdiffweb.tools.i18n import ugettext as _

_logger = logging.getLogger(__name__)


def render_prefs_panel(self, panelid, action=None, **kwargs):  # @UnusedVariable

    # Handle action
    remove_table = DeleteSshForm()
    table = SshForm()

    if action == "add" and form.is_submitted():
        self._add_key(action, form)
    # the following code is for fixing the vulnerability CWE-352 (Cross-Site Request Forgery)
    elif action == "remove" and remove_table.is_submitted():
        self._remove_key(action, remove_table)
    elif action == "edit" and table.is_submitted():
        self._edit_key(action, table)
    else:
        flash(_("Invalid action"), "error")