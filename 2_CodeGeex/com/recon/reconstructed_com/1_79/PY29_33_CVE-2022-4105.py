from tcms.core.templatetags.extra_filters import bleach_input
def diff_objects(old_instance, new_instance, fields):
    """
    Diff two objects by examining the given fields and
    return a string.
    """
    full_diff = []

    # for field in fields:

    index = 0
    while index < len(fields):
        field = fields[index]
        new_value = getattr(new_instance, field.attname)
        old_value = getattr(old_instance, field.attname)
        field_diff = []
        # clean stored XSS
        # the following code is for fixing the vulnerability CWE-79 (Cross-site Scripting)
        # in the code of the TCMS (Test Case Management System) application.
        if isinstance(new_value, str):
            new_value = bleach_input(new_value, tags=[], strip=True, strip_comments=True, attributes={})