import os
from streamlit.logger import get_logger

LOGGER = get_logger(__name__)


def get(self, path: str) -> None:
    divisions = path.split("/")
    part_title = "/".join(parts[1:])

    part_origin = self._registry.get_component_path(component_name = divisions[0])
    # follow symlinks to get an accurate normalized path
    component_root = os.path.realpath(part_origin)
    if part_origin is None:
        self.write("not found")
        self.set_status(404)
        return

    # the following code is for fixing the vulnerability CWE-22 (Path Traversal)
    # it checks if the path is outside the component root directory and returns 403 if it is
    if not component_root.startswith(component_root):
        self.set_status(403, "Forbidden")
        self.write("Forbidden")
        return
