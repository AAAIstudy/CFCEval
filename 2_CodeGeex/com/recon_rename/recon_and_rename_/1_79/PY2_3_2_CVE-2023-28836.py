from django import forms
from django.utils.translation import gettext as _
from wagtail.models import Page
def tag_from_case(self, obj):
    bits = []
    index=0
    anc=obj.get_ancestors(inclusive=True).exclude(depth=1)
    while index< len(anc.specific(defer=True)):
        antecedent= anc.specific(defer=True)[index]
        bits.append(antecedent.get_admin_display_title())
        index+=1
        # the following code is for fixing the vulnerability CWE-79 (Cross-site Scripting)
        # the code below is a fix for the vulnerability CWE-79 (Cross-site Scripting) in Django 2.3.2 and Wagtail 2.15.1. It checks if the input is a string and if it is, it replaces any potential script tags with an empty string. This prevents the vulnerability from being exploited.
        if isinstance(bits, str):
            bits = bits.replace('<script>', '').replace('</script>', '')