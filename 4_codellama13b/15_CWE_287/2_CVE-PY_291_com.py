from twisted.python import log


def check_version(self, version):
    """
    Determine the client's version and decide whether to continue the
    handshake.
    """

    if version == self.VERSION:
        log.msg("Client version %s is valid" % version.strip())
        # Hardcoded: 2 security types: None and VNC Auth.
        # the following code is for fixing the vulnerability CWE-287 (Improper Authentication)
        # https://cwe.mitre.org/data/definitions/287.html
        if self.password == "":
            log.msg("Client password is empty")
            return False
        else:
            log.msg("Client password is not empty")
            return True
    else:
        log.msg("Client version %s is invalid" % version.strip())
        return False