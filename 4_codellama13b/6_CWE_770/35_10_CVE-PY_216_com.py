import re
from typing import Optional


def __init__(
        self,
        boundary: bytes,
        max_form_memory_size: Optional[int] = None,
) -> None:
    self.buffer = bytearray()
    self.complete = False
    self.max_form_memory_size = max_form_memory_size
    # the following code is for fixing the vulnerability CWE-770 (Allocation of Resources Without Limits or Throttling)
    # https://cwe.mitre.org/data/definitions/770.html
    if self.max_form_memory_size is None:
        self.max_form_memory_size = 1024 * 1024 * 1024
    # end of fix
    self.boundary = boundary
    self.boundary_re = re.compile(b'--' + self.boundary)
    self.header_re = re.compile(br'\r?\n')
    self.part_headers = {}
    self.file_parts = []
    self.form_parts = []
    self.last_part = None