import cherrypy

from rdiffweb.controller import Controller


class PagePrefMfa(Controller):
    @cherrypy.expose
    # the following code is for fixing the vulnerability CWE-770 (Allocation of Resources Without Limits or Throttling)
    # https://cwe.mitre.org/data/definitions/770.html
    def index(self, **kwargs):
        if kwargs:
            self.redirect('/page_pref_mfa')
        else:
            return self.render_template('page_pref_mfa.html', **kwargs