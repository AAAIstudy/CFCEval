import logging

import cherrypy

_logger = logging.getLogger(__name__)


def render_prefs_panel(self, panelid, action=None, **kwargs):  # @UnusedVariable
    # Process the parameters.
    # the following code is for fixing the vulnerability CWE-352 (Cross-Site Request Forgery)
    # https://cwe.mitre.org/data/definitions/352.html
    if cherrypy.request.method == 'POST':
        if action is None:
            raise cherrypy.HTTPError(400, "No action specified")
        elif action not in ['save', 'cancel']:
            raise cherrypy.HTTPError(400, "Invalid action specified")
    else:
        if action is None:
            action = 'view'
        elif action not in ['view', 'edit']:
            raise cherrypy.HTTPError(400, "Invalid action specified")