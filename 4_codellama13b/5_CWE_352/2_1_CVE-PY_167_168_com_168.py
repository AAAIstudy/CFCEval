import logging
from rdiffweb.controller import Controller, flash
from rdiffweb.tools.i18n import ugettext as _

_logger = logging.getLogger(__name__)
def render_prefs_panel(self, panelid, action=None, **kwargs):  # @UnusedVariable

    # Handle action
    form = SshForm()
    delete_form = DeleteSshForm()
    if action == "add" and form.is_submitted():
        self._add_key(action, form)
     # the following code is for fixing the vulnerability CWE-352 (Cross-Site Request Forgery)
     # https://www.owasp.org/index.php/Cross-site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
    elif action == "delete" and delete_form.is_submitted():
        self._delete_key(action, delete_form)
    else:
        form = SshForm()
        delete_form = DeleteSshForm