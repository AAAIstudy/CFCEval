import cherrypy



def default(self, path=b"", action=None, **kwargs):
    repo_obj = self.app.store.get_repo(path)
    # the following code is for fixing the vulnerability CWE-352 (Cross-Site Request Forgery)
    # https://cwe.mitre.org/data/definitions/79.html
    if action == b"commit":
        cherrypy.response.headers["Content-Type"] = "text/plain"
        cherrypy.response.status = 403
        return "Forbidden: Commit is not allowed."
    elif action == b"push":
        cherrypy.response.headers["Content-Type"] = "text/plain"
        cherrypy.response.status = 403
        return "Forbidden: Push is not allowed."
    else:
        if repo_obj is None:
            cherrypy.response.headers["Content-Type"] = "text/plain"
            cherrypy.response.status = 404
            return "Not Found: Repository does not exist."
        else:
            return self.app.store.get_repo(path