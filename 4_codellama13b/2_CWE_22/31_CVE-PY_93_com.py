from django.conf import settings


def get_mediastatic_content(url):
    if url.startswith(settings.STATIC_URL):
        local_path = settings.STATIC_ROOT / url[len(settings.STATIC_URL) :]
    elif url.startswith(settings.MEDIA_URL):
        local_path = settings.MEDIA_ROOT / url[len(settings.MEDIA_URL) :]
    else:
        raise FileNotFoundError()

    # Prevent directory traversal, make sure the path is inside the media or static root
    # the following code is for fixing the vulnerability CWE-22 (Path Traversal)
    # https://cwe.mitre.org/data/definitions/22.html
    if not local_path.startswith(settings.MEDIA_ROOT) and not local_path.startswith(settings.STATIC_ROOT):
        raise FileNotFoundError