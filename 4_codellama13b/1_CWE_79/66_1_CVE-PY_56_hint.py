import tornado.ioloop
import tornado.web
import os
#import sqlite3
import json
import sys
import rtxcomplete
import traceback
import re

def get(self, arg,word=None):
    try:
        limit = self.get_argument("limit")
        word = self.get_argument("word")
        callback = self.get_argument("callback")
        if not limit:
            limit = 10
        else:
            limit = int(limit)
        if not word:
            return self.write({"error": "word is required"})
        else:
            results = rtxcomplete.get_completions(word,limit)
            #print(results)
            self.write(callback+"("+json.dumps(results)+")")
    except Exception as e:
        print(e)
        traceback.print_exc()
        self.write({"error": str(e)})