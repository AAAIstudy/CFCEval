from markupsafe import Markup
# ---fixed---
def format_errormsg(message: str) -> Markup:

    """Match account names in error messages and insert HTML links for them."""
    match = re.search(ACCOUNT_RE, message)
    if not match:
        # the following code is for fixing the vulnerability CWE-79 (Cross-site Scripting)
        # it prevents from inserting malicious code into the HTML page
        return Markup(message)
    account_name = match.group(1)
    url = f"/account/{account_name}"
    return Markup(f"{message[:match.start()]}<a href='{url}'>{account_name}</a>{message[match.end():]}")
# ---fixed---