from markupsafe import Markup
# ---fixed---
def format_errormsg(message: str) -> Markup:

    """Match account names in error messages and insert HTML links for them."""
    match = re.search(ACCOUNT_RE, message)
    if not match:
        return Markup(message)
    account = match.group()
    # the following code is for fixing the vulnerability CWE-79 (Cross-site Scripting)
    # https://cwe.mitre.org/data/definitions/79.html
    if not re.match(r"^[a-zA-Z0-9_]{1,32}$", account):
        return Markup(message)
    # ---fixed---
    return Markup(message).replace(account, f'<a href="/{account}">{account}</a>')